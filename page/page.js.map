{
  "version": 3,
  "sources": ["../src/strings.js", "../src/ui/tabs/tabMenu.js", "../src/ui/tabs/tabSearch.js", "../src/utils/utils.js", "../src/api/authp.js", "../src/api/api.js", "../src/ui/tabs/reviews/reviewsComments.js", "../src/ui/tabs/reviews/reviewsRating.js", "../src/ui/tabs/reviews/reviewsSummaries.js", "../src/ui/tabs/reviews/reviewsContentBox.js", "../src/ui/tabs/tabTeacher.js", "../src/ui/tabs/tabSubject.js", "../src/ui/tabs/tabLogin.js", "../src/ui/tabs/creation/addReviewForm.js", "../src/ui/tabs/tabAddReview.js", "../src/ui/main.js", "../src/page.js"],
  "sourcesContent": ["export const loadingText = \"\u0417\u0430\u0433\u0440\u0443\u0436\u0430\u0435\u043C...\";\r\n\r\nconst tip = \"<br/>(\u043E\u0431\u043D\u043E\u0432\u0438\u0442\u0435 \u0440\u0430\u0441\u0448\u0438\u0440\u0435\u043D\u0438\u0435/\u0441\u0430\u0439\u0442)\";\r\n\r\nexport const fewCharactersText = \"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0445\u043E\u0442\u044F \u0431\u044B 3 \u0441\u0438\u043C\u0432\u043E\u043B\u0430 =]\";\r\nexport const unknownTypeText = `<span class=\"error\">\u041D\u0435 \u043F\u043E\u043D\u044F\u0442\u043D\u043E, \u0447\u0442\u043E \u044D\u0442\u043E \u0442\u0430\u043A\u043E\u0435 :|</span>` + tip;\r\n\r\nexport const brokeReviewsText = \"\u041E\u0442\u0437\u044B\u0432\u044B \u043F\u0440\u0438\u0448\u043B\u0438 \u0441\u043B\u043E\u043C\u0430\u043D\u043D\u044B\u0435 =(\" + tip;\r\nexport const brokeSearchText = \"\u0420\u0435\u0437\u0443\u043B\u044C\u0442\u0430\u0442\u044B \u043F\u0440\u0438\u0448\u043B\u0438 \u0441\u043B\u043E\u043C\u0430\u043D\u043D\u044B\u0435 =(\" + tip;\r\n\r\nexport const emptyCommentsList = \"\u041E\u0442\u0437\u044B\u0432\u044B \u043E\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u044E\u0442 \\\\(O_o)/\";\r\n\r\n/** \u041E\u0448\u0438\u0431\u043A\u0438 \u043F\u0440\u0438 \u0437\u0430\u0433\u0440\u0443\u0437\u043A\u0435 \u043E\u0442\u0437\u044B\u0432\u043E\u0432 **/\r\nexport function statusReviewsText(status) {\r\n    switch (status) {\r\n        case 0: return `<span class=\"error\">\u0421\u0435\u0440\u0432\u0435\u0440 \u0441 \u043E\u0442\u0437\u044B\u0432\u0430\u043C\u0438 \u043D\u0435\u0434\u043E\u0441\u0442\u0443\u043F\u0435\u043D =(</span>`;\r\n        case 401: return \"\u0421\u043D\u0430\u0447\u0430\u043B\u0430 \u0432\u043E\u0439\u0434\u0438\u0442\u0435, \u044D\u0442\u043E \u0431\u044B\u0441\u0442\u0440\u043E =)\";\r\n        case 404: return \"\u041E\u0442\u0437\u044B\u0432\u044B \u043E\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u044E\u0442 \\\\(O_o)/\";\r\n        default: return `\u0421\u0435\u0440\u0432\u0435\u0440 \u043F\u0440\u0438\u0441\u043B\u0430\u043B \"${status}\" \u0432\u043C\u0435\u0441\u0442\u043E \u043E\u0442\u0437\u044B\u0432\u043E\u0432 =(`;\r\n    }\r\n}\r\n\r\n/** \u041E\u0448\u0438\u0431\u043A\u0438 \u043F\u0440\u0438 \u0437\u0430\u0433\u0440\u0443\u0437\u043A\u0435 \u043F\u043E\u0438\u0441\u043A\u0430 **/\r\nexport function statusSearchText(status) {\r\n    switch (status) {\r\n        case 0: return `<span class=\"error\">\u0421\u0435\u0440\u0432\u0435\u0440 \u0441 \u043E\u0442\u0437\u044B\u0432\u0430\u043C\u0438 \u043D\u0435\u0434\u043E\u0441\u0442\u0443\u043F\u0435\u043D =(</span>`;\r\n        case 401: return \"\u0421\u043D\u0430\u0447\u0430\u043B\u0430 \u0432\u043E\u0439\u0434\u0438\u0442\u0435, \u044D\u0442\u043E \u0431\u044B\u0441\u0442\u0440\u043E =)\";\r\n        case 404: return \"\u041D\u0438\u0447\u0435\u0433\u043E \u043D\u0435 \u043D\u0430\u0439\u0434\u0435\u043D\u043E \\\\(O_o)/\";\r\n        default: return `\u0421\u0435\u0440\u0432\u0435\u0440 \u043F\u0440\u0438\u0441\u043B\u0430\u043B \"${status}\" \u0432\u043C\u0435\u0441\u0442\u043E \u0440\u0435\u0437\u0443\u043B\u044C\u0442\u0430\u0442\u043E\u0432 \u043F\u043E\u0438\u0441\u043A\u0430 =(`;\r\n    }\r\n}\r\n\r\n/** \u041D\u0430\u0434\u043F\u0438\u0441\u044C \u043E \u043D\u0430\u043B\u0438\u0447\u0438\u0438 \u0442\u043E\u043A\u0435\u043D\u0430 */\r\nexport function authStatusText(isu, name) {\r\n    return name ? `${name} (${isu})` : `${isu}`;\r\n}\r\n\r\n/** \u0418\u043A\u043E\u043D\u043A\u0438 */\r\nexport const symbols = {\"teacher\": \"\uD83D\uDC68\u200D\uD83C\uDFEB\", \"subject\": \"\uD83D\uDCDA\", \"add\": \"\u2795\"};\r\n\r\n/** AuthP */\r\nexport const authpLabel = `\u042D\u0442\u043E \u0430\u0432\u0442\u043E\u0440\u0438\u0437\u0430\u0446\u0438\u044F \u043F\u043E <b>ID.ITMO</b> \u0447\u0435\u0440\u0435\u0437 \u043F\u0440\u043E\u043A\u0441\u0438.<br/>\r\n\u041D\u0430\u0436\u0438\u043C\u0430\u044F \u043A\u043D\u043E\u043F\u043A\u0443 \"\u0412\u0445\u043E\u0434\" \u0432\u044B \u0434\u0430\u0451\u0442\u0435 \u0441\u043E\u0433\u043B\u0430\u0441\u0438\u0435 \u043D\u0430 <b>\u043E\u0431\u0440\u0430\u0431\u043E\u0442\u043A\u0443 \u043F\u0435\u0440\u0441\u043E\u043D\u0430\u043B\u044C\u043D\u044B\u0445 \u0434\u0430\u043D\u043D\u044B\u0445</b>:<br/>\r\n<i>\u0421\u0430\u0439\u0442 \u043E\u0431\u0440\u0430\u0431\u0430\u0442\u044B\u0432\u0430\u0435\u0442 \u0443\u043D\u0438\u043A\u0430\u043B\u044C\u043D\u044B\u0439 \u0438\u0434\u0435\u043D\u0442\u0438\u0444\u0438\u043A\u0430\u0442\u043E\u0440 \u043F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B\u044F (ISU) \u0434\u043B\u044F \u043F\u0440\u0435\u0434\u043E\u0442\u0432\u0440\u0430\u0449\u0435\u043D\u0438\u044F \u043D\u0430\u043A\u0440\u0443\u0442\u043E\u043A \u0438 \u043E\u0431\u0435\u0441\u043F\u0435\u0447\u0435\u043D\u0438\u044F \u0440\u0430\u0431\u043E\u0442\u044B \u0441\u0435\u0440\u0432\u0438\u0441\u0430. <br/>\r\n\u0414\u0430\u043D\u043D\u044B\u0435 \u043D\u0435 \u043F\u0435\u0440\u0435\u0434\u0430\u044E\u0442\u0441\u044F \u0442\u0440\u0435\u0442\u044C\u0438\u043C \u043B\u0438\u0446\u0430\u043C. \u041F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B\u044C \u043C\u043E\u0436\u0435\u0442 \u0437\u0430\u043F\u0440\u043E\u0441\u0438\u0442\u044C \u0443\u0434\u0430\u043B\u0435\u043D\u0438\u0435 \u0441\u0432\u043E\u0438\u0445 \u0434\u0430\u043D\u043D\u044B\u0445.</i>\r\n`;\r\n\r\nexport const authpCredentials = \"\u041D\u0435\u0432\u0435\u0440\u043D\u044B\u0435 \u043B\u043E\u0433\u0438\u043D \u0438\u043B\u0438 \u043F\u0430\u0440\u043E\u043B\u044C!\"\r\nexport const authpError = \"\u041F\u0440\u043E\u0432\u0435\u0440\u044C\u0442\u0435 \u043B\u043E\u0433\u0438\u043D \u0438 \u043F\u0430\u0440\u043E\u043B\u044C! \u041F\u0440\u043E\u0446\u0435\u0441\u0441 \u0430\u0432\u0442\u043E\u0440\u0438\u0437\u0430\u0446\u0438\u0438 \u0431\u044B\u043B \u043D\u0430\u0440\u0443\u0448\u0435\u043D\"\r\n\r\nexport const loginBtnLabel = \"\u0412\u0445\u043E\u0434\";\r\nexport const loginLoadingBtnLabel = \"\u0412\u0445\u043E\u0434 \u231B\";\r\n\r\n/** \u041C\u0435\u043D\u044E */\r\nexport const menuLogoutBtnLabel = `<span class=\"error\">\uD83D\uDC94 \u0412\u044B\u0439\u0442\u0438 \u0438\u0437 \u0430\u043A\u043A\u0430\u0443\u043D\u0442\u0430</span>`;\r\nexport const menuAddReviewBtnLabel = \"\uD83D\uDCDD \u041D\u0430\u043F\u0438\u0441\u0430\u0442\u044C \u043E\u0442\u0437\u044B\u0432\";\r\nexport const menuMyReviewBtnLabel = \"\uD83D\uDCCB \u041C\u043E\u0434\u0435\u0440\u0430\u0446\u0438\u044F\";\r\n\r\n/** \u0417\u0430\u0433\u043E\u043B\u043E\u0432\u043A\u0438 */\r\nexport const mainHeader = \"\u041F\u043E\u0438\u0441\u043A \u043E\u0442\u0437\u044B\u0432\u043E\u0432\";\r\nexport const loginHeader = \"\u0412\u0445\u043E\u0434\";\r\nexport const addHeader = \"\u041D\u043E\u0432\u044B\u0439 \u043E\u0442\u0437\u044B\u0432\";\r\n", "import * as strings from \"../../strings.js\";\r\n\r\n/** \u041C\u0435\u043D\u044E */\r\nexport function createMenu(isAuth, isUserModerator, logoutCallback, openAddReviewCallback) {\r\n    const wrapper = document.createElement(\"div\");\r\n    wrapper.classList.add(\"reviews-menu\");\r\n\r\n    const addReviewButton = document.createElement(\"button\");\r\n    addReviewButton.classList.add(\"reviews-menu-item\");\r\n    addReviewButton.innerHTML = strings.menuAddReviewBtnLabel;\r\n    addReviewButton.addEventListener(\"click\", openAddReviewCallback)\r\n    // addReviewButton.disabled = true;\r\n    wrapper.appendChild(addReviewButton);\r\n\r\n    if (isUserModerator) {\r\n        const myReviewButton = document.createElement(\"button\");\r\n        myReviewButton.classList.add(\"reviews-menu-item\");\r\n        myReviewButton.innerHTML = strings.menuMyReviewBtnLabel;\r\n        myReviewButton.disabled = true;\r\n        wrapper.appendChild(myReviewButton);\r\n    }\r\n\r\n    if (isAuth) {\r\n        const logoutButton = document.createElement(\"button\");\r\n        logoutButton.classList.add(\"reviews-menu-item\");\r\n        logoutButton.innerHTML = strings.menuLogoutBtnLabel;\r\n        logoutButton.addEventListener(\"click\", logoutCallback)\r\n        wrapper.appendChild(logoutButton);\r\n    }\r\n\r\n    return wrapper;\r\n}\r\n", "import * as strings from \"../../strings.js\";\r\n\r\n/** \u0411\u043B\u043E\u043A \u0440\u0435\u0437\u0443\u043B\u044C\u0442\u0430\u0442\u043E\u0432 \u043F\u043E\u0438\u0441\u043A\u0430\r\n * @param {SearchResponse} data\r\n * @param {function} callback\r\n * */\r\nexport function createSearch(data, callback) {\r\n    const wrapper = document.createElement('div');\r\n    wrapper.className = 'search-list';\r\n\r\n    data.results.forEach(s => {\r\n        const item = document.createElement('div');\r\n        item.className = 'search-item';\r\n        item.innerHTML = `\r\n            ${strings.symbols[s.type] || ''}\r\n            ${s.title}\r\n            <span class=\"search-id\">${s.id}</span>\r\n        `;\r\n        item.addEventListener('click', async () => callback(s.id, s.type, s.title));\r\n        wrapper.appendChild(item);\r\n    });\r\n\r\n    return wrapper;\r\n}\r\n", "export function parseJwt(token) {\r\n    try {\r\n        const base64 = token.split('.')[1]\r\n            .replace(/-/g, '+')\r\n            .replace(/_/g, '/');\r\n\r\n        const binary = atob(base64);\r\n        const bytes = Uint8Array.from(binary, c => c.charCodeAt(0));\r\n        const json = new TextDecoder('utf-8').decode(bytes);\r\n\r\n        return JSON.parse(json);\r\n    } catch (e) {\r\n        console.error('\u041E\u0448\u0438\u0431\u043A\u0430 \u043F\u0430\u0440\u0441\u0438\u043D\u0433\u0430 JWT', e);\r\n        return null;\r\n    }\r\n}\r\n\r\nexport function parseCommentDate(dateStr) {\r\n    if (!dateStr) return -Infinity;\r\n\r\n    // \"\u0434\u043E YYYY\"\r\n    const untilMatch = dateStr.toLowerCase().match(/^\u0434\u043E\\s+(\\d{4})$/);\r\n    if (untilMatch) {\r\n        const [, year] = untilMatch;\r\n        // Return \"00:00 01.01.YYYY\"\r\n        return new Date(\r\n            Number(year),\r\n            0,\r\n            1,\r\n            0,\r\n            0\r\n        ).getTime();\r\n    }\r\n\r\n    // \"HH:MM DD.MM.YYYY\"\r\n    const match = dateStr.match(\r\n        /(\\d{2}):(\\d{2})\\s+(\\d{2})\\.(\\d{2})\\.(\\d{4})/\r\n    );\r\n    if (!match) {\r\n        return -Infinity;\r\n    }\r\n\r\n    const [, hh, mm, dd, MM, yyyy] = match;\r\n    return new Date(\r\n        Number(yyyy),\r\n        Number(MM) - 1,\r\n        Number(dd),\r\n        Number(hh),\r\n        Number(mm)\r\n    ).getTime();\r\n}\r\n\r\nexport function setCookie(key, value, options = {}) {\r\n    const {\r\n        days = 1,\r\n        path = '/',\r\n        sameSite = 'Lax',\r\n        secure = false\r\n    } = options;\r\n\r\n    let cookie = `${encodeURIComponent(key)}=${encodeURIComponent(value)}`;\r\n\r\n    if (days) {\r\n        cookie += `; max-age=${days * 86400}`;\r\n    }\r\n\r\n    cookie += `; path=${path}`;\r\n    cookie += `; SameSite=${sameSite}`;\r\n\r\n    if (secure) {\r\n        cookie += '; Secure';\r\n    }\r\n\r\n    document.cookie = cookie;\r\n}\r\n\r\nexport function getCookie(key) {\r\n    const match = document.cookie\r\n        .split('; ')\r\n        .find(row => row.startsWith(encodeURIComponent(key) + '='));\r\n\r\n    return match\r\n        ? decodeURIComponent(match.split('=')[1])\r\n        : null;\r\n}\r\n\r\nexport function normalizeString(str) {\r\n    if (typeof str !== 'string') return '';\r\n\r\n    return str\r\n        .normalize('NFKC') // \u043D\u043E\u0440\u043C\u0430\u043B\u0438\u0437\u0430\u0446\u0438\u044F Unicode (\u043E\u0431\u044A\u0435\u0434\u0438\u043D\u044F\u0435\u0442 \u0434\u0438\u0430\u043A\u0440\u0438\u0442\u0438\u043A\u0438)\r\n        .replace(/[\\s\\uFEFF\\xA0]+/g, ' ') // \u0432\u0441\u0435 \u043F\u0440\u043E\u0431\u0435\u043B\u044C\u043D\u044B\u0435 \u0441\u0438\u043C\u0432\u043E\u043B\u044B \u0432 1 \u043F\u0440\u043E\u0431\u0435\u043B\r\n        .trim(); // \u0443\u0434\u0430\u043B\u044F\u0435\u043C \u043F\u0440\u043E\u0431\u0435\u043B\u044B \u0441 \u043A\u043E\u043D\u0446\u043E\u0432\r\n}\r\n", "import {parseJwt, setCookie, getCookie} from \"../utils/utils.js\";\r\n\r\nlet isExtension = false;\r\nexport let refreshToken = null;\r\nexport let accessToken = null;\r\nlet accessTokenExpiration = 0;\r\nconst TIMEOUT = 300;\r\n\r\nexport function isAuth() {\r\n    return refreshToken !== null\r\n}\r\n\r\nfunction setTokens(rToken, aToken) {\r\n    refreshToken = rToken;\r\n    accessToken = aToken;\r\n\r\n    /** @type {JWTPayload} */\r\n    const payload = parseJwt(accessToken);\r\n    if (payload?.exp) accessTokenExpiration = payload.exp || 0;\r\n}\r\n\r\nexport function isAccessTokenExpired() {\r\n    return Date.now() >= (accessTokenExpiration * 1000 - TIMEOUT * 1000);\r\n}\r\n\r\nexport function validateTokenISU(aToken) {\r\n    /** @type {JWTPayload} */\r\n    const payload = parseJwt(aToken);\r\n    if (!payload?.isu) {\r\n        console.error('[AUTHP] isu not found');\r\n        return false;\r\n    }\r\n    return true;\r\n}\r\n\r\nexport function saveTokensExtension(rToken, aToken) {\r\n    isExtension = true;\r\n    if (!chrome.runtime?.id) return;\r\n    chrome.storage.local.set({ refresh_token: rToken, access_token: aToken }, () => {\r\n        const err = chrome.runtime.lastError;\r\n        if (err && !err.message.includes('Extension context invalidated')) {\r\n            console.error(err);\r\n        } else {\r\n            setTokens(rToken, aToken);\r\n            console.log('[AUTHP] tokens saved successfully');\r\n        }\r\n    });\r\n}\r\n\r\nexport function loadTokensExtension() {\r\n    isExtension = true;\r\n    return new Promise((resolve, reject) => {\r\n        chrome.storage.local.get((data) => {\r\n            const rToken = data.refresh_token;\r\n            const aToken = data.access_token;\r\n            if (rToken && aToken) {\r\n                setTokens(rToken, aToken);\r\n                const payloadAT = parseJwt(aToken);\r\n                if (payloadAT) resolve(payloadAT);\r\n                else reject();\r\n            } else reject();\r\n        })\r\n    })\r\n}\r\n\r\nexport function resetTokensExtension() {\r\n    isExtension = true;\r\n    chrome.storage.local.remove([\"refresh_token\", \"access_token\"]);\r\n    refreshToken = null;\r\n    accessToken = null;\r\n    accessTokenExpiration = 0;\r\n}\r\n\r\nexport function saveTokensPage(rToken, aToken) {\r\n    isExtension = false;\r\n    setCookie('refresh_token', rToken, {secure: false});\r\n    setCookie('access_token', aToken, {secure: false});\r\n}\r\n\r\nexport function loadTokensPage() {\r\n    isExtension = false;\r\n    return new Promise((resolve, reject) => {\r\n        const rToken = getCookie('refresh_token');\r\n        const aToken = getCookie('access_token');\r\n        if (rToken && aToken) {\r\n            setTokens(rToken, aToken);\r\n            const payloadAT = parseJwt(aToken);\r\n            if (payloadAT) resolve(payloadAT);\r\n            else reject();\r\n        } else reject();\r\n    })\r\n}\r\n\r\nexport function resetTokensPage() {\r\n    isExtension = false;\r\n    document.cookie = 'refresh_token=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;';\r\n    document.cookie = 'access_token=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;';\r\n    refreshToken = null;\r\n    accessToken = null;\r\n    accessTokenExpiration = 0;\r\n}\r\n\r\nexport function saveTokensAuto(rToken, aToken) {\r\n    if (isExtension) saveTokensExtension(rToken, aToken);\r\n    else saveTokensPage(rToken, aToken);\r\n}\r\n\r\nexport function loadTokensAuto() {\r\n    if (isExtension) return loadTokensExtension();\r\n    else return loadTokensPage();\r\n}\r\n\r\nexport function resetTokensAuto() {\r\n    if (isExtension) resetTokensExtension();\r\n    else resetTokensPage();\r\n}\r\n", "import {refreshToken, accessToken, isAccessTokenExpired,\r\n    resetTokensAuto, saveTokensAuto, validateTokenISU} from \"./authp.js\";\r\n\r\n/** \u041F\u043E\u0434\u043C\u0435\u043D\u044F\u0435\u0442\u0441\u044F \u043D\u0430 \u044D\u0442\u0430\u043F\u0435 \u043A\u043E\u043C\u043F\u0438\u043B\u044F\u0446\u0438\u0438 */\r\n/* global API_HOST */\r\n\r\n/** \u0423\u043D\u0438\u0432\u0435\u0440\u0441\u0430\u043B\u044C\u043D\u0430\u044F \u043E\u0431\u0451\u0440\u0442\u043A\u0430 \u0434\u043B\u044F \u0437\u0430\u043F\u0440\u043E\u0441\u043E\u0432 \u043A API\r\n * @param {string} path\r\n * @param {Object} options\r\n * @param {'GET' | 'POST' | 'PUT' | 'DELETE'} method\r\n * @param {AbortController} [controller]\r\n */\r\nasync function fetchJSON(method, path, options = {}, controller = null) {\r\n    const url = new URL(path, API_HOST);\r\n\r\n    const fetchOptions = {\r\n        method: method.toUpperCase(),\r\n        headers: {\r\n            'Content-Type': 'application/json'\r\n        },\r\n        signal: controller?.signal\r\n    };\r\n\r\n    if (refreshToken) {\r\n        try {\r\n            if (!accessToken || isAccessTokenExpired()) {\r\n                const urlRefresh = new URL(\"/authp/refresh\", API_HOST);\r\n                const resp = await fetch(urlRefresh, {\r\n                    method: 'POST',\r\n                    headers: {'Content-Type': 'application/json'},\r\n                    body: JSON.stringify({'refresh_token': refreshToken})\r\n                })\r\n                if (resp.ok) {\r\n                    const res = await resp.json()\r\n                    const aToken = res?.access_token;\r\n                    if (aToken && validateTokenISU(aToken)) {\r\n                        saveTokensAuto(refreshToken, aToken);\r\n                    }\r\n                } else {\r\n                    console.error('[API] Refresh status code ' + resp.status);\r\n                    resetTokensAuto();\r\n                }\r\n            }\r\n            if (accessToken) fetchOptions.headers['token'] = accessToken;\r\n        } catch (err) {\r\n            console.error('[API] Unable to refresh the token', err);\r\n        }\r\n    }\r\n\r\n    if (fetchOptions.method === 'GET') {\r\n        Object.entries(options).forEach(([key, value]) => {\r\n            url.searchParams.set(key, value.toString());\r\n        });\r\n    } else {\r\n        fetchOptions.body = JSON.stringify(options);\r\n    }\r\n\r\n    return new Promise((resolve, reject) => {\r\n        fetch(url, fetchOptions).then(async (res) => {\r\n            if (res.ok) {\r\n                console.log(`[API] fetch resolved`);\r\n                const text = await res.text();\r\n                resolve(text ? JSON.parse(text) : {});\r\n            } else {\r\n                const errorDetail = await res.json().catch(() => ({}));\r\n                if (res.status === 401 || res.status === 404) {\r\n                    console.info('[API] error details:', errorDetail);\r\n                } else {\r\n                    console.error('[API] error details:', errorDetail);\r\n                }\r\n                reject(res.status);\r\n            }\r\n        }).catch((err) => {\r\n            if (err.name !== 'AbortError') {\r\n                console.error('[API] network error:', err);\r\n                reject(0);\r\n            } else {\r\n                console.log(`[API] fetch aborted`);\r\n            }\r\n        });\r\n    });\r\n}\r\n\r\nexport async function fetchSearch(query, controller, strainer=null) {\r\n    console.log(`[API] send /search for \"${query}\"`);\r\n    const options = strainer === null ? {\"query\": query} : {\"query\": query, \"strainer\": strainer}\r\n    return await fetchJSON('GET', '/search', options, controller)\r\n}\r\n\r\nexport async function fetchTeacher(id) {\r\n    console.log(`[API] send /teacher for \"${id}\"`);\r\n    return await fetchJSON('GET', `/teacher/${id}`, {})\r\n}\r\n\r\nexport async function fetchSubject(id) {\r\n    console.log(`[API] send /subject for \"${id}\"`);\r\n    return await fetchJSON('GET', `/subject/${id}`, {})\r\n}\r\n\r\nexport async function fetchTeacherRate(id, user_rating) {\r\n    console.log(`[API] send /teacher/${id}/rate ${user_rating}`);\r\n    return await fetchJSON('POST', `/teacher/${id}/rate`, {\"user_rating\": user_rating})\r\n}\r\n\r\nexport async function fetchCommentVote(id, user_karma) {\r\n    console.log(`[API] send /comment/${id}/vote ${user_karma}`);\r\n    return await fetchJSON('POST', `/comment/${id}/vote`, {\"user_karma\": user_karma})\r\n}\r\n\r\nexport async function fetchAuthPLogin(username, password) {\r\n    console.log(`[API] send /authp/login`);\r\n    return await fetchJSON('POST', `/authp/login`, {\"username\": username, \"password\": password})\r\n}\r\n\r\nexport async function fetchIsModerator() {\r\n    console.log(`[API] send GET /moderator`);\r\n    return await fetchJSON('GET', `/moderator`)\r\n}\r\n\r\nexport async function fetchSendSuggestion(body) {\r\n    console.log(`[API] send POST /suggestion`);\r\n    return await fetchJSON('POST', `/suggestion`, body)\r\n}\r\n\r\nexport async function fetchGetSuggestionList() {\r\n    console.log(`[API] send GET /suggestion`);\r\n    return await fetchJSON('GET', `/suggestion`)\r\n}\r\n\r\nexport async function fetchGetSuggestion(id) {\r\n    console.log(`[API] send GET /suggestion/${id}`);\r\n    return await fetchJSON('POST', `/suggestion/${id}`)\r\n}\r\n\r\nexport async function fetchCommitSuggestion(id, body) {\r\n    console.log(`[API] send POST /suggestion/${id}/commit`);\r\n    return await fetchJSON('POST', `/suggestion/${id}/commit`, body)\r\n}\r\n\r\nexport async function fetchCancelSuggestion(id, status='rejected') {\r\n    console.log(`[API] send POST /suggestion/${id}/cancel status=${status}`);\r\n    return await fetchJSON('POST', `/suggestion/${id}/cancel`, {'status': status})\r\n}\r\n", "import {parseCommentDate} from \"../../../utils/utils.js\";\r\nimport {fetchCommentVote} from \"../../../api/api.js\";\r\n\r\n\r\n/** \u0421\u043E\u0437\u0434\u0430\u0451\u043C \u0431\u043B\u043E\u043A \u043E\u0442\u0437\u044B\u0432\u043E\u0432\r\n * @param {Array<Comment>} commentsData - \u0414\u0430\u043D\u043D\u044B\u0435 \u0441\u043F\u0438\u0441\u043A\u0430 \u043E\u0442\u0437\u044B\u0432\u043E\u0432\r\n * @returns {HTMLDivElement}\r\n */\r\nexport default function createComments(commentsData) {\r\n    const wrapper = document.createElement('div');\r\n    wrapper.classList.add('comments-wrap');\r\n\r\n    let commentsList = createCommentsList(commentsData);\r\n\r\n    if (commentsData.length > 1) {\r\n        const dropdown = createDropdown(commentsData);\r\n        dropdown.addEventListener(\"change\", (event) => {\r\n            const model = parseInt(event.target.value);\r\n            console.log(`[UI] sorting model ${model}`);\r\n            const newCL = createCommentsList(commentsData, model);\r\n            wrapper.replaceChild(newCL, commentsList);\r\n            commentsList = newCL;\r\n        });\r\n        wrapper.appendChild(dropdown);\r\n    }\r\n    wrapper.appendChild(commentsList);\r\n\r\n    return wrapper;\r\n}\r\n\r\n/** \u0421\u043E\u0437\u0434\u0430\u0451\u043C \u043E\u0442\u0441\u043E\u0440\u0442\u0438\u0440\u043E\u0432\u0430\u043D\u043D\u044B\u0439 \u0441\u043F\u0438\u0441\u043E\u043A \u043E\u0442\u0437\u044B\u0432\u043E\u0432\r\n * @param {Array<Comment>} commentsData - \u0414\u0430\u043D\u043D\u044B\u0435 \u0441\u043F\u0438\u0441\u043A\u0430 \u043E\u0442\u0437\u044B\u0432\u043E\u0432\r\n * @param {number} model - \u0420\u0435\u0436\u0438\u043C \u0441\u043E\u0440\u0442\u0438\u0440\u043E\u0432\u043A\u0438\r\n */\r\nfunction createCommentsList(commentsData, model = 0) {\r\n    const wrapper = document.createElement('div');\r\n    wrapper.classList.add('comments');\r\n    const sortedCommentsData = sortComments(commentsData, model);\r\n    sortedCommentsData.map(cData => wrapper.append(createComment(cData)));\r\n    return wrapper;\r\n}\r\n\r\n/** \u0421\u043E\u0437\u0434\u0430\u043D\u0438\u0435 \u043E\u0442\u0437\u044B\u0432\u0430\r\n * @param {Comment} comment - \u0414\u0430\u043D\u043D\u044B\u0435 \u043E\u0442\u0437\u044B\u0432\u0430\r\n */\r\nfunction createComment(comment) {\r\n    const wrapper = document.createElement(\"div\");\r\n    wrapper.classList.add(\"comment\");\r\n    wrapper.innerHTML = `\r\n        <div class=\"comment-head\">\r\n            \u041E\u0442\u0437\u044B\u0432 ${comment.date}\r\n            ${comment?.subject ? ` \u043F\u043E \u043F\u0440\u0435\u0434\u043C\u0435\u0442\u0443 \"${comment.subject.title}\"` : ' '}\r\n            ${comment?.source ? ` \u0438\u0441\u0442\u043E\u0447\u043D\u0438\u043A \"<a href=\"${comment.source.link ?? ''}\">${comment.source.title}</a>\"` : ''}\r\n        </div>\r\n        <div>${comment.text}</div>\r\n    `\r\n    wrapper.appendChild(createKarma(comment.id, comment.karma, comment.user_karma));\r\n    return wrapper\r\n}\r\n\r\n/** \u0421\u043E\u0437\u0434\u0430\u043D\u0438\u0435 \u043F\u0430\u043D\u0435\u043B\u044C\u043A\u0438 \u043A\u0430\u0440\u043C\u044B \u25B2\u25BC\u25B3\u25BD */\r\nfunction createKarma(id, karma, user_karma) {\r\n    const wrapper = document.createElement(\"div\");\r\n    wrapper.classList.add(\"karma\");\r\n    const karmaSpan = document.createElement(\"span\");\r\n    karmaSpan.classList.add(\"karma-value\");\r\n    const upBtn = document.createElement(\"button\");\r\n    upBtn.classList.add(\"karma-btn\");\r\n    const downBtn = document.createElement(\"button\");\r\n    downBtn.classList.add(\"karma-btn\");\r\n\r\n    upBtn.addEventListener(\"click\", async (_event) => {\r\n        const data = await fetchCommentVote(id, user_karma === 1 ? 0 : 1);\r\n        user_karma = data.user_karma;\r\n        karma = data.karma;\r\n        updateKarma(karmaSpan, upBtn, downBtn, karma, user_karma);\r\n    })\r\n    downBtn.addEventListener(\"click\", async (_event) => {\r\n        const data = await fetchCommentVote(id, user_karma === -1 ? 0 : -1 );\r\n        user_karma = data.user_karma;\r\n        karma = data.karma;\r\n        updateKarma(karmaSpan, upBtn, downBtn, karma, user_karma);\r\n    })\r\n\r\n    updateKarma(karmaSpan, upBtn, downBtn, karma, user_karma)\r\n\r\n    wrapper.appendChild(upBtn);\r\n    wrapper.appendChild(karmaSpan);\r\n    wrapper.appendChild(downBtn);\r\n    return wrapper\r\n}\r\n\r\n/** \u041E\u0431\u043D\u043E\u0432\u043B\u044F\u0435\u043C \u0441\u043E\u0441\u0442\u043E\u044F\u043D\u0438\u0435 \u043F\u0430\u043D\u0435\u043B\u0438 \u043A\u0430\u0440\u043C\u044B */\r\nfunction updateKarma(karmaSpan, upBtn, downBtn, karma, user_karma) {\r\n    if (user_karma === null || user_karma === undefined) user_karma = 0;\r\n    karmaSpan.innerHTML = karma;\r\n    upBtn.innerHTML = user_karma === 1 ? \"\u25B2\" : \"\u25B3\"\r\n    downBtn.innerHTML = user_karma === -1 ? \"\u25BC\" : \"\u25BD\"\r\n}\r\n\r\n/** \u0412\u044B\u043F\u0430\u0434\u0430\u044E\u0449\u0438\u0439 \u0441\u043F\u0438\u0441\u043E\u043A \u043C\u043E\u0434\u0435\u043B\u0435\u0439 \u0441\u043E\u0440\u0442\u0438\u0440\u043E\u0432\u043A\u0438 */\r\nfunction createDropdown() {\r\n    const wrapper = document.createElement(\"select\");\r\n    wrapper.name = \"sort\";\r\n    wrapper.classList.add(\"comments-dropdown\");\r\n    wrapper.innerHTML = `\r\n        <option value=\"0\">C \u0432\u044B\u0441\u043E\u043A\u043E\u0439 \u043A\u0430\u0440\u043C\u044B</option>\r\n        <option value=\"1\">\u0421 \u043D\u0438\u0437\u043A\u043E\u0439 \u043A\u0430\u0440\u043C\u044B</option>\r\n        <option value=\"2\">\u0421\u043D\u0430\u0447\u0430\u043B\u0430 \u043D\u043E\u0432\u044B\u0435</option>\r\n        <option value=\"3\">\u0421\u043D\u0430\u0447\u0430\u043B\u0430 \u0441\u0442\u0430\u0440\u044B\u0435</option>`\r\n    return wrapper;\r\n}\r\n\r\n/** \u0421\u043E\u0440\u0442\u0438\u0440\u043E\u0432\u043A\u0430 \u043C\u0430\u0441\u0441\u0438\u0432\u0430 \u043A\u043E\u043C\u043C\u0435\u043D\u0442\u0430\u0440\u0438\u0435\u0432 \u0441\u043E\u0433\u043B\u0430\u0441\u043D\u043E \u043C\u043E\u0434\u0435\u043B\u0438 */\r\nfunction sortComments(comments, model = 0) {\r\n    return [...comments].sort((a, b) => {\r\n        const timeA = parseCommentDate(a.date);\r\n        const timeB = parseCommentDate(b.date);\r\n        let diff;\r\n        switch (model) {\r\n            case 0:\r\n                diff = b.karma - a.karma;\r\n                if (diff === 0) {\r\n                    if (Number.isNaN(timeA) || Number.isNaN(timeB)) return 0;\r\n                    else return timeB - timeA;\r\n                }\r\n                return diff;\r\n            case 1:\r\n                diff = a.karma - b.karma;\r\n                if (diff === 0) {\r\n                    if (Number.isNaN(timeA) || Number.isNaN(timeB)) return 0;\r\n                    else return timeB - timeA;\r\n                }\r\n                return diff;\r\n            case 2:\r\n                if (Number.isNaN(timeA) || Number.isNaN(timeB)) return 0;\r\n                else return timeB - timeA;\r\n            case 3:\r\n                if (Number.isNaN(timeA) || Number.isNaN(timeB)) return 0;\r\n                else return timeA - timeB;\r\n            default: return 0;\r\n        }\r\n    });\r\n}\r\n", "import {fetchTeacherRate} from \"../../../api/api.js\";\r\n\r\n\r\n/** \u0421\u043E\u0437\u0434\u0430\u0451\u043C \u0431\u043B\u043E\u043A \u0440\u0435\u0439\u0442\u0438\u043D\u0433\u0430 */\r\nexport default function createRating(id, rating, user_rating) {\r\n    const wrapper = document.createElement(\"div\");\r\n    wrapper.classList.add(\"rating-box\")\r\n\r\n    wrapper.innerHTML = renderRating(id, rating, user_rating)\r\n\r\n    wrapper.addEventListener('change', async (event) => {\r\n        if (event.target.name === `rating-${id}`) {\r\n            const newRate = parseInt(event.target.value);\r\n\r\n            const data = await fetchTeacherRate(id, newRate);\r\n            wrapper.innerHTML = renderRating(id, data.rating, data.user_rating);\r\n        }\r\n    });\r\n\r\n    return wrapper;\r\n}\r\n\r\n/** \u0420\u0438\u0441\u0443\u0435\u043C \u0431\u043B\u043E\u043A \u0440\u0435\u0439\u0442\u0438\u043D\u0433\u0430 */\r\nfunction renderRating(id, rating, user_rating) {\r\n    if (user_rating === null || user_rating === undefined) user_rating = 0;\r\n    const stars = [5, 4, 3, 2, 1].map(num => `\r\n        <input type=\"radio\" id=\"rate-${id}-${num}\" name=\"rating-${id}\" value=\"${num}\" ${user_rating === num ? 'checked' : ''}>\r\n        <label for=\"rate-${id}-${num}\">\u2605</label>\r\n    `).join('');\r\n\r\n    return `\r\n        <div class=\"rating-row\">\r\n            <span class=\"rating-title\">\u0421\u0440\u0435\u0434\u043D\u044F\u044F \u043E\u0446\u0435\u043D\u043A\u0430:</span>\r\n            <span class=\"rating-value\">${rating}</span>\r\n        </div>\r\n        <div class=\"rating-row\">\r\n            <span class=\"rating-title\">\u0412\u0430\u0448\u0430 \u043E\u0446\u0435\u043D\u043A\u0430:</span>\r\n            <div class=\"rating\">${stars}</div>\r\n        </div>\r\n    `\r\n}\r\n", "/** \u0421\u043E\u0437\u0434\u0430\u0451\u043C \u0431\u043B\u043E\u043A \u043F\u0430\u0440\u0430\u043C\u0435\u0442\u0440-\u0437\u043D\u0430\u0447\u0435\u043D\u0438\u0435 */\r\nexport default function createSummaries(summariesData) {\r\n    const summariesHTML = summariesData.map(item => `\r\n        <div class=\"summary\">\r\n            <span class=\"summary-title\">${item.title ?? ''}</span>: \r\n            <span class=\"summary-value\">${item.value ?? ''}</span>\r\n        </div>\r\n    `).join('');\r\n\r\n    const summaries = document.createElement('div');\r\n    summaries.classList.add('summaries');\r\n    summaries.innerHTML = summariesHTML;\r\n    return summaries;\r\n}\r\n", "import createComments from \"./reviewsComments.js\";\r\nimport createRating from \"./reviewsRating.js\";\r\nimport createSummaries from \"./reviewsSummaries.js\";\r\nimport * as strings from \"../../../strings.js\";\r\n\r\n\r\n/** \u0421\u043E\u0437\u0434\u0430\u0451\u043C \u043A\u043E\u043D\u0442\u0435\u043D\u0442 \u043F\u043E \u043F\u0440\u0435\u043F\u043E\u0434\u0430\u0432\u0430\u0442\u0435\u043B\u044E: \u0440\u0435\u0439\u0442\u0438\u043D\u0433, \u043E\u0442\u0437\u044B\u0432\u044B \u0438 \u043E\u0441\u0442\u0430\u043B\u044C\u043D\u043E\u0435\r\n * @param {Teacher} data\r\n */\r\nexport default function createReviewsContentBox(data) {\r\n    if (!data ||\r\n        !Array.isArray(data.summaries) ||\r\n        !Array.isArray(data.comments)\r\n    ) return null;\r\n\r\n    const wrapper = document.createElement('div');\r\n    wrapper.classList.add(\"reviews-content-box\");\r\n\r\n    wrapper.appendChild(createRating(data.id, data.rating, data?.user_rating));\r\n    if (data.summaries.length !== 0) {\r\n        wrapper.appendChild(createSummaries(data.summaries));\r\n    }\r\n    if (data.comments.length !== 0) {\r\n        wrapper.appendChild(createComments(data.comments));\r\n    }\r\n    if (data.summaries.length === 0 && data.comments.length === 0) {\r\n        const comment = document.createElement('p')\r\n        comment.classList.add(\"comment\");\r\n        comment.innerHTML = strings.emptyCommentsList;\r\n        wrapper.appendChild(comment)\r\n    }\r\n\r\n    return wrapper;\r\n}\r\n", "import createReviewsContentBox from \"./reviews/reviewsContentBox.js\";\r\n\r\n/** \u0411\u043B\u043E\u043A \u043E\u0442\u0437\u044B\u0432\u043E\u0432 \u043F\u043E \u0443\u0447\u0438\u0442\u0435\u043B\u044E \u0434\u043B\u044F popup\r\n * @param {Teacher} data\r\n * */\r\nexport function createTeacher(data) {\r\n    const reviewBox = createReviewsContentBox(data);\r\n    if (reviewBox === null) return null;\r\n\r\n    const wrapper = document.createElement('div');\r\n    wrapper.innerHTML = `<h2>${data.name}</h2>`\r\n    wrapper.appendChild(reviewBox);\r\n\r\n    return wrapper;\r\n}", "import createReviewsContentBox from \"./reviews/reviewsContentBox.js\";\r\n\r\n/** \u0411\u043B\u043E\u043A \u043E\u0442\u0437\u044B\u0432\u043E\u0432 \u043F\u043E \u043F\u0440\u0435\u0434\u043C\u0435\u0442\u0443 \u0434\u043B\u044F popup\r\n * @param {Subject} data\r\n * */\r\nexport function createSubject(data) {\r\n    if (!data || !Array.isArray(data.teachers)) return null;\r\n\r\n    data.teachers.sort((a, b) => {\r\n        const rating = b.rating - a.rating\r\n        if (rating === 0) return b.id - a.id;\r\n        return rating\r\n    });\r\n\r\n    const reviewBoxes = data.teachers.map(teacher => createReviewsContentBox(teacher));\r\n    if (reviewBoxes.some(box => box === null)) return null;\r\n\r\n    const wrapper = document.createElement('div');\r\n    wrapper.innerHTML = `<h2>${data.title}</h2>`;\r\n    data.teachers.forEach((teacher, i) => {\r\n        const box = document.createElement(\"details\");\r\n        box.innerHTML = `<summary class=\"reviews-title\">${teacher.name}</summary>`;\r\n        box.appendChild(reviewBoxes[i]);\r\n        wrapper.appendChild(box);\r\n    })\r\n    return wrapper;\r\n}", "import * as strings from \"../../strings.js\";\r\nimport {fetchAuthPLogin} from \"../../api/api.js\";\r\nimport {validateTokenISU, saveTokensPage} from \"../../api/authp.js\";\r\n\r\nexport function createLoginForm(loginCallback) {\r\n    const form = document.createElement(\"form\");\r\n    form.classList.add(\"login-form\");\r\n    form.innerHTML = `\r\n        <p>${strings.authpLabel}</p>\r\n    \r\n        <input type=\"email\" name=\"email\" placeholder=\"E-mail\" required />\r\n        <input type=\"password\" name=\"password\" placeholder=\"\u041F\u0430\u0440\u043E\u043B\u044C\" required />\r\n    \r\n        <button id=\"authp-login\" type=\"submit\">\u0412\u0445\u043E\u0434</button>\r\n    `\r\n    const loginButton = form.querySelector(\"#authp-login\");\r\n    form.addEventListener('submit', async (e) => {\r\n        e.preventDefault();\r\n\r\n        loginButton.disabled = true;\r\n        loginButton.innerHTML = strings.loginLoadingBtnLabel;\r\n        fetchAuthPLogin(form.email.value, form.password.value).then(resp => {\r\n            const rToken = resp?.refresh_token;\r\n            const aToken = resp?.access_token;\r\n            if (!rToken || !aToken) {\r\n                console.error(\"[AUTHP] Invalid response\", resp);\r\n                loginButton.disabled = false;\r\n                loginButton.innerHTML = strings.loginBtnLabel;\r\n                return;\r\n            }\r\n            if (!validateTokenISU(aToken)) return;\r\n            saveTokensPage(rToken, aToken);\r\n\r\n            loginCallback()\r\n        }).catch(status => {\r\n            if (status === 401) {alert(strings.authpCredentials)}\r\n            else alert(strings.authpError + ` (\u0441\u0442\u0430\u0442\u0443\u0441 ${status})`);\r\n            loginButton.disabled = false;\r\n            loginButton.innerHTML = strings.loginBtnLabel;\r\n        });\r\n    });\r\n    return form;\r\n}", "export const MAX_INPUT = 64;\r\nexport const MAX_TEXTAREA = 10000;\r\n\r\nexport function getElements(root) {\r\n    return {\r\n        teacher: {\r\n            input: root.querySelector(\"#addrev-teacher-input\"),\r\n            reset: root.querySelector(\"#addrev-teacher-input-reset\"),\r\n            container: root.querySelector(\"#addrev-teacher-container\"),\r\n            status: root.querySelector(\"#addrev-teacher-status\"),\r\n        },\r\n        subject: {\r\n            input: root.querySelector(\"#addrev-subject-input\"),\r\n            reset: root.querySelector(\"#addrev-subject-input-reset\"),\r\n            container: root.querySelector(\"#addrev-subject-container\"),\r\n            status: root.querySelector(\"#addrev-subject-status\"),\r\n        },\r\n        subs: {\r\n            input: root.querySelector(\"#addrev-sub-input\"),\r\n            reset: root.querySelector(\"#addrev-sub-input-reset\"),\r\n            container: root.querySelector(\"#addrev-sub-container\"),\r\n            status: root.querySelector(\"#addrev-sub-status\"),\r\n        },\r\n        comment: {\r\n            input: root.querySelector(\"#addrev-comment-input\"),\r\n            counter: root.querySelector(\"#addrev-comment-char-count\"),\r\n        },\r\n        submit: root.querySelector(\"#addrev-commit\"),\r\n        cancel: root.querySelector(\"#addrev-cancel\"),\r\n    };\r\n}\r\n\r\nexport function renderAddReviewForm(isUserModerator) {\r\n    return `\r\n        <p class=\"add-rev-label\">* \u0414\u043E\u0431\u0430\u0432\u043B\u0435\u043D\u0438\u0435 \u043D\u043E\u0432\u043E\u0433\u043E \u043E\u0442\u0437\u044B\u0432\u0430, \u0434\u043B\u044F \u043F\u0440\u0435\u043F\u043E\u0434\u0430\u0432\u0430\u0442\u0435\u043B\u044F...</p>\r\n        <div id=\"addrev-teacher-input-wrapper\" class=\"rev-input-wrapper\">\r\n            <label for=\"addrev-teacher-input\">\u0424\u0418\u041E \u043F\u0440\u0435\u043F\u043E\u0434\u0430\u0432\u0430\u0442\u0435\u043B\u044F</label>\r\n            <input type=\"text\" id=\"addrev-teacher-input\" class=\"rev-input\" \r\n                placeholder=\"\u0418\u0432\u0430\u043D\u043E\u0432 \u0418\u0432\u0430\u043D \u0418\u0432\u0430\u043D\u043E\u0432\u0438\u0447\" \r\n                maxlength=\"${MAX_INPUT}\"/>\r\n            <button type=\"reset\" id=\"addrev-teacher-input-reset\" class=\"rev-input-reset\">&times;</button>\r\n        </div>\r\n        <div id=\"addrev-teacher-container\"></div>\r\n        <p id=\"addrev-teacher-status\" class=\"add-rev-status\">\u041D\u0438\u043A\u043E\u0433\u043E \u043D\u0435 \u0432\u044B\u0431\u0440\u0430\u043D\u043E</p>\r\n        \r\n        <p class=\"add-rev-label\">* \u041F\u043E \u043A\u0430\u043A\u043E\u043C\u0443 \u043F\u0440\u0435\u0434\u043C\u0435\u0442\u0443 \u0432\u044B \u0435\u0433\u043E \u0437\u043D\u0430\u0435\u0442\u0435? <i>(\u0412\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u043E\u0441\u043D\u043E\u0432\u043D\u043E\u0439)</i></p>\r\n        <div id=\"addrev-subject-input-wrapper\" class=\"rev-input-wrapper\">\r\n            <label for=\"addrev-subject-input\">\u041D\u0430\u0437\u0432\u0430\u043D\u0438\u0435 \u043F\u0440\u0435\u0434\u043C\u0435\u0442\u0430</label>\r\n            <input type=\"text\" id=\"addrev-subject-input\" class=\"rev-input\" \r\n            placeholder=\"\u041C\u0430\u0442\u0435\u043C\u0430\u0442\u0438\u0447\u0435\u0441\u043A\u0438\u0439 \u0430\u043D\u0430\u043B\u0438\u0437\" \r\n            maxlength=\"${MAX_INPUT}\"/>\r\n            <button type=\"reset\" id=\"addrev-subject-input-reset\" class=\"rev-input-reset\">&times;</button>\r\n        </div>\r\n        <div id=\"addrev-subject-container\"></div>\r\n        <p id=\"addrev-subject-status\" class=\"add-rev-status\">\u041D\u0438\u0447\u0435\u0433\u043E \u043D\u0435 \u0432\u044B\u0431\u0440\u0430\u043D\u043E</p>\r\n        \r\n        <p class=\"add-rev-label\">\u041A\u0430\u043A\u0438\u0435 \u0435\u0449\u0435 \u043F\u0440\u0435\u0434\u043C\u0435\u0442\u044B \u0432\u0435\u0434\u0435\u0442? <i>(\u041E\u0442\u043C\u0435\u0442\u044C\u0442\u0435, \u0435\u0441\u043B\u0438 \u0437\u043D\u0430\u0435\u0442\u0435)</i></p>\r\n        <div id=\"addrev-sub-input-wrapper\" class=\"rev-input-wrapper\">\r\n            <label for=\"addrev-sub-input\">\u041D\u0430\u0437\u0432\u0430\u043D\u0438\u0435 \u043F\u0440\u0435\u0434\u043C\u0435\u0442\u0430</label>\r\n            <input type=\"text\" id=\"addrev-sub-input\" class=\"rev-input\" \r\n                placeholder=\"\u0410\u043B\u0433\u0435\u0431\u0440\u0430\" \r\n                maxlength=\"${MAX_INPUT}\"/>\r\n            <button type=\"reset\" id=\"addrev-sub-input-reset\" class=\"rev-input-reset\">&times;</button>\r\n        </div>\r\n        <div id=\"addrev-sub-container\"></div>\r\n        <div id=\"addrev-sub-status\">\r\n            <p class=\"add-rev-status\">\u041D\u0438\u0447\u0435\u0433\u043E \u043D\u0435 \u0432\u044B\u0431\u0440\u0430\u043D\u043E</p>\r\n        </div>\r\n                \r\n        <p class=\"add-rev-label\">\r\n            * \u0427\u0442\u043E \u043C\u043E\u0436\u0435\u0442\u0435 \u043E \u043D\u0451\u043C \u0441\u043A\u0430\u0437\u0430\u0442\u044C? <br/>\r\n            <i>\u041A\u0430\u043A \u043E\u0442\u043D\u043E\u0441\u0438\u0442\u044C\u0441\u044F \u043A \u0441\u0442\u0443\u0434\u0435\u043D\u0442\u0430\u043C? \u041A\u0430\u043A \u043F\u0440\u0435\u043F\u043E\u0434\u0430\u0451\u0442? \u0422\u0440\u0443\u0434\u043D\u043E \u043B\u0438 \u0437\u0430\u043A\u0440\u044B\u0442\u044C\u0441\u044F? \u0423\u043A\u0430\u0436\u0438\u0442\u0435 \u0443\u0440\u043E\u0432\u0435\u043D\u044C, \u0435\u0441\u043B\u0438 \u044D\u0442\u043E \u0430\u043D\u0433\u043B\u0438\u0439\u0441\u043A\u0438\u0439.</i>\r\n        </p>\r\n        <div class=\"comment-textarea-wrapper\">\r\n            <label for=\"addrev-comment-input\">\u041A\u043E\u043C\u043C\u0435\u043D\u0442\u0430\u0440\u0438\u0439</label>\r\n            <textarea\r\n                    id=\"addrev-comment-input\"\r\n                    class=\"comment-input\"\r\n                    placeholder=\"\u041C\u043E\u0436\u043D\u043E \u043F\u0438\u0441\u0430\u0442\u044C \u043A\u0440\u0430\u0442\u043A\u043E (\u043E\u0431\u044B\u0447\u043D\u043E \u043F\u0438\u0448\u0443\u0442 3\u20135 \u043F\u0440\u0435\u0434\u043B\u043E\u0436\u0435\u043D\u0438\u0439)...\"\r\n                    maxlength=\"${MAX_TEXTAREA}\"\r\n            ></textarea>\r\n            <div class=\"comment-char-counter\">\r\n                <span id=\"addrev-comment-char-count\">0</span>/${MAX_TEXTAREA}\r\n            </div>\r\n        </div>\r\n        <button id=\"addrev-commit\" class=\"rev-button\">\r\n            ${isUserModerator ? \"\u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C \u043E\u0442\u0437\u044B\u0432\" : \"\u041E\u0442\u043F\u0440\u0430\u0432\u0438\u0442\u044C \u0430\u043D\u043E\u043D\u0438\u043C\u043D\u044B\u0439 \u043E\u0442\u0437\u044B\u0432\"}\r\n        </button>\r\n        <button id=\"addrev-cancel\" class=\"rev-button-s\">\r\n            ${isUserModerator ? \"\u041E\u0442\u043A\u043B\u043E\u043D\u0438\u0442\u044C \u043E\u0442\u0437\u044B\u0432\" : \"\u041E\u0447\u0438\u0441\u0442\u0438\u0442\u044C\"}\r\n        </button>\r\n    `\r\n}", "import * as strings from \"../../strings.js\";\r\nimport {normalizeString} from \"../../utils/utils.js\"\r\nimport {renderAddReviewForm, getElements, MAX_TEXTAREA} from \"./creation/addReviewForm.js\";\r\nimport {fetchCancelSuggestion, fetchSearch, fetchSendSuggestion} from \"../../api/api.js\";\r\nimport {createSearch} from \"./tabSearch.js\";\r\n\r\nlet isUserModerator = false;\r\nlet clearFormCallback = undefined;\r\nconst emptyState = {\r\n    id: null,\r\n    teacher: {\r\n        id: null,\r\n        title: null,\r\n    },\r\n    subject: {\r\n        id: null,\r\n        title: null,\r\n    },\r\n    subs: new Map(),\r\n    comment: \"\",\r\n}\r\nlet state = structuredClone(emptyState);\r\n\r\n/** \u0424\u043E\u0440\u043C\u0430 \u0434\u043E\u0431\u0430\u0432\u043B\u0435\u043D\u0438\u044F \u043E\u0442\u0437\u044B\u0432\u0430 */\r\nexport function createAddReviewForm(clearFormCallbackLocal, modeModerator=false, suggestionId=null) {\r\n    isUserModerator = modeModerator;\r\n    clearFormCallback = clearFormCallbackLocal;\r\n\r\n    const wrapper = document.createElement(\"div\");\r\n    wrapper.innerHTML = renderAddReviewForm(isUserModerator);\r\n\r\n    const root = getElements(wrapper);\r\n\r\n    bindEvents(wrapper, root)\r\n\r\n    refreshForm(root);\r\n\r\n    return wrapper;\r\n}\r\n\r\nconst inputState = {\r\n    teacher: {\r\n        type: \"teacher\",\r\n        controller: undefined,\r\n        timeout: undefined,\r\n        value: \"\",\r\n    },\r\n    subject: {\r\n        type: \"subject\",\r\n        controller: undefined,\r\n        timeout: undefined,\r\n        value: \"\",\r\n    },\r\n    subs: {\r\n        type: \"subject\",\r\n        controller: undefined,\r\n        timeout: undefined,\r\n        value: \"\",\r\n    },\r\n};\r\n\r\nfunction bindEvents(wrapper, root) {\r\n    wrapper.addEventListener(\"click\", (e) => {\r\n        if (e.target === root.teacher.reset) {\r\n            root.teacher.input.value = \"\";\r\n            root.teacher.container.innerHTML = \"\";\r\n        }\r\n        if (e.target === root.subject.reset) {\r\n            root.subject.input.value = \"\";\r\n            root.subject.container.innerHTML = \"\";\r\n        }\r\n        if (e.target === root.subs.reset) {\r\n            root.subs.input.value = \"\";\r\n            root.subs.container.innerHTML = \"\";\r\n        }\r\n        if (e.target.classList.contains('rev-list-item-reset')) {\r\n            const key = e.target.getAttribute('data-id');\r\n            state.subs.delete(key)\r\n            refreshList(root.subs, state.subs);\r\n        }\r\n        if (e.target === root.cancel) {\r\n            if (isUserModerator) {\r\n                cancelSuggestion()\r\n            } else {\r\n                clearForm(root);\r\n            }\r\n        }\r\n        if (e.target === root.submit) {\r\n            if (isUserModerator) {\r\n                // TODO: commitSuggestion\r\n            } else {\r\n                sendSuggestion()\r\n            }\r\n\r\n        }\r\n    });\r\n    function inputEvent (e)  {\r\n        if (e.target === root.comment.input) {\r\n            state.comment = root.comment.input.value;\r\n\r\n            const length = root.comment.input.value.length;\r\n            root.comment.counter.textContent = length.toString()\r\n\r\n            const exceeded = length >= MAX_TEXTAREA;\r\n            root.comment.input.classList.toggle('limit-exceeded', exceeded);\r\n            root.comment.counter.parentElement.classList.toggle('limit-exceeded', exceeded);\r\n\r\n            const scrollY = window.scrollY;\r\n            root.comment.input.style.height = 'auto';\r\n            root.comment.input.style.height = root.comment.input.scrollHeight + 'px';\r\n            window.scrollTo(window.scrollX, scrollY + 1000);\r\n        }\r\n        if (e.target === root.teacher.input) {\r\n            inputState.teacher.value = root.teacher.input.value;\r\n            clearTimeout(inputState.teacher.timeout);\r\n            inputState.teacher.timeout = setTimeout(() => {\r\n                search(\r\n                    root.teacher,\r\n                    inputState.teacher,\r\n                    state.teacher,\r\n                    loadSingle\r\n                );}, 300\r\n            );\r\n        }\r\n        if (e.target === root.subject.input) {\r\n            inputState.subject.value = root.subject.input.value;\r\n            clearTimeout(inputState.subject.timeout);\r\n            inputState.subject.timeout = setTimeout(() => {\r\n                search(\r\n                    root.subject,\r\n                    inputState.subject,\r\n                    state.subject,\r\n                    loadSingle\r\n                );}, 300\r\n            );\r\n        }\r\n        if (e.target === root.subs.input) {\r\n            inputState.subs.value = root.subs.input.value;\r\n            clearTimeout(inputState.subs.timeout);\r\n            inputState.subs.timeout = setTimeout(() => {\r\n                search(\r\n                    root.subs,\r\n                    inputState.subs,\r\n                    state.subs,\r\n                    loadList\r\n                );}, 300\r\n            );\r\n        }\r\n    }\r\n    wrapper.addEventListener(\"input\", inputEvent)\r\n    wrapper.addEventListener(\"keydown\", (event) => {\r\n        if (event.key === 'Enter') {\r\n            inputEvent(event)\r\n        }\r\n    })\r\n}\r\n\r\nfunction sendSuggestion() {\r\n    if (state.teacher.title === null) {\r\n        alert(\"\u041F\u043E\u0436\u0430\u043B\u0443\u0439\u0441\u0442\u0430, \u0432\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u043F\u0440\u0435\u043F\u043E\u0434\u0430\u0432\u0430\u0442\u0435\u043B\u044F =]\");\r\n        return;\r\n    }\r\n    if (state.subject.title === null) {\r\n        alert(\"\u041F\u043E\u0436\u0430\u043B\u0443\u0439\u0441\u0442\u0430, \u0432\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u043E\u0441\u043D\u043E\u0432\u043D\u043E\u0439 \u043F\u0440\u0435\u0434\u043C\u0435\u0442 =]\");\r\n        return;\r\n    }\r\n    if (normalizeString(state.comment).length === 0) {\r\n        alert(\"\u041D\u0435 \u0441\u043B\u0438\u0448\u043A\u043E\u043C \u043B\u0438 \u043C\u0430\u043B\u043E \u0432\u044B \u043D\u0430\u043F\u0438\u0441\u0430\u043B\u0438?)\");\r\n        return;\r\n    }\r\n    const requestBody = {\r\n        teacher: state.teacher,\r\n        subject: state.subject,\r\n        subs: Array.from(state.subs.values()),\r\n        text: state.comment,\r\n    }\r\n    // console.info(JSON.stringify(requestBody));\r\n    fetchSendSuggestion(requestBody).then(_ => {\r\n        alert(\"\u0421\u043F\u0430\u0441\u0438\u0431\u043E! \u041E\u0442\u0437\u044B\u0432 \u0431\u0443\u0434\u0435\u0442 \u043E\u043F\u0443\u0431\u043B\u0438\u043A\u043E\u0432\u0430\u043D \u043A\u0430\u043A \u0442\u043E\u043B\u044C\u043A\u043E \u043F\u0440\u043E\u0439\u0434\u0451\u0442 \u043C\u043E\u0434\u0435\u0440\u0430\u0446\u0438\u044E =)\")\r\n        state = structuredClone(emptyState);\r\n        clearFormCallback();\r\n    }).catch(status => {\r\n        alert(`\u0421\u0435\u0440\u0432\u0435\u0440 \u043E\u0442\u0432\u0435\u0442\u0438\u043B ${status}`)\r\n    })\r\n}\r\n\r\nfunction cancelSuggestion() {\r\n    if (state.id !== null) {\r\n        const confirmation = confirm(\"\u041E\u0442\u043A\u043B\u043E\u043D\u0438\u0442\u044C \u043E\u0442\u0437\u044B\u0432?\");\r\n        if (confirmation) {\r\n            /** @param {SuggestionCancelResponse} data */\r\n            fetchCancelSuggestion(state.id, 'rejected').then(data => {\r\n                if (data.status === 'rejected') {\r\n                    clearFormCallback();\r\n                } else {\r\n                    alert(`\u041E\u0442\u043A\u043B\u043E\u043D\u0438\u0442\u044C \u043E\u0442\u0437\u044B\u0432 \u043D\u0435 \u0443\u0434\u0430\u043B\u043E\u0441\u044C, \u043E\u043D \u0432 \u0441\u043E\u0441\u0442\u043E\u044F\u043D\u0438\u0438: ${data.status}`);\r\n                }\r\n            }).catch(status => {\r\n                alert(`\u0421\u0435\u0440\u0432\u0435\u0440 \u043E\u0442\u0432\u0435\u0442\u0438\u043B ${status}`);\r\n            })\r\n        }\r\n    } else {\r\n        alert('State.id \u043F\u0443\u0441\u0442\u043E\u0439!')\r\n    }\r\n}\r\n\r\nfunction search(rootEl, is, s, load) {\r\n    if (!is.value || is.value.length < 3) return;\r\n\r\n    is.controller?.abort();\r\n    is.controller = new AbortController();\r\n\r\n    fetchSearch(normalizeString(is.value), is.controller, is.type).then(data => {\r\n        rootEl.container.innerHTML = \"\";\r\n        data.results.push({\r\n            id: -1,\r\n            title: \"\u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C \u043D\u043E\u0432\u044B\u0439\",\r\n            type: \"add\"\r\n        })\r\n        const searchBox = createSearch(data, (id, type, title) => {load(rootEl, is, s, id, type, title)});\r\n        if (searchBox) rootEl.container.appendChild(searchBox);\r\n        else rootEl.container.innerHTML = strings.brokeSearchText;\r\n    }).catch(status => {\r\n        rootEl.container.innerHTML = strings.statusSearchText(status);\r\n        if (status === 404) {\r\n            const dt = {\r\n                results: [{\r\n                    id: -1,\r\n                    title: \"\u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C \u043D\u043E\u0432\u044B\u0439\",\r\n                    type: \"add\"\r\n                }],\r\n            }\r\n            const searchBox = createSearch(dt, (id, type, title) => {\r\n                load(rootEl, is, s, id, type, title)\r\n            });\r\n            if (searchBox) rootEl.container.appendChild(searchBox);\r\n        }\r\n    })\r\n}\r\n\r\nfunction loadSingle(rootEl, is, s, id, type, title) {\r\n    rootEl.container.innerHTML = \"\";\r\n    if (type !== is.type && type !== \"add\") return;\r\n\r\n    if (type === \"add\") {\r\n        const newTitle = normalizeString(is.value)\r\n        if (newTitle.length === 0) return;\r\n        s.id = null;\r\n        s.title = newTitle;\r\n    } else {\r\n        s.id = id;\r\n        s.title = title;\r\n    }\r\n\r\n    refreshSingle(rootEl, s)\r\n}\r\n\r\nfunction refreshSingle(rootEl, s) {\r\n    if (s.title === null) {\r\n        rootEl.status.innerHTML = `\u041D\u0438\u0447\u0435\u0433\u043E \u043D\u0435 \u0432\u044B\u0431\u0440\u0430\u043D\u043E`;\r\n        return;\r\n    }\r\n    if (s.id === null) {\r\n        rootEl.status.innerHTML = `\u0414\u043E\u0431\u0430\u0432\u043B\u0435\u043D \u043D\u043E\u0432\u044B\u0439: <span class=\"normal-text\">${s.title}</span>`;\r\n    }\r\n    rootEl.status.innerHTML = `\u0412\u044B\u0431\u0440\u0430\u043D: <span class=\"normal-text\">${s.title}</span>`;\r\n\r\n    rootEl.input.value = \"\";\r\n    rootEl.input.placeholder = s.title;\r\n}\r\n\r\nfunction loadList(rootEl, is, s, id, type, title) {\r\n    rootEl.container.innerHTML = \"\";\r\n    if (type !== is.type && type !== \"add\") return;\r\n\r\n    if (type === \"add\") {\r\n        id = null;\r\n        title = is.value;\r\n    }\r\n\r\n    s.set(title, {\r\n        id: id,\r\n        title: title\r\n    })\r\n    refreshList(rootEl, s)\r\n}\r\n\r\nfunction refreshList(rootEl, s) {\r\n    if (s.size === 0) {\r\n        rootEl.status.innerHTML = `<p class=\"add-rev-status\">\u041D\u0438\u0447\u0435\u0433\u043E \u043D\u0435 \u0432\u044B\u0431\u0440\u0430\u043D\u043E</p>`;\r\n        return;\r\n    }\r\n\r\n    const revList = document.createElement(\"div\");\r\n    revList.classList.add(\"rev-list\");\r\n\r\n    revList.innerHTML = `\r\n        <div class=\"rev-list\">\r\n            <p class=\"rev-list-title\">\u0412\u044B\u0431\u0440\u0430\u043D\u043E: </p>\r\n            ${Array.from(s, ([title, item]) => `\r\n                <div class=\"rev-list-item\">\r\n                    ${item.id === null ? `<span class=\"muted-text\">(\u043D\u043E\u0432\u044B\u0439)</span>` : ''}\r\n                    ${item.title}\r\n                    <button class=\"rev-list-item-reset\" data-id=\"${title}\">&times;</button>\r\n                </div>\r\n            `).join('')}\r\n        </div>\r\n    `;\r\n\r\n    rootEl.status.innerHTML = \"\";\r\n    rootEl.status.appendChild(revList);\r\n}\r\n\r\nfunction refreshComment(rootEl, s) {\r\n    rootEl.input.value = s;\r\n}\r\n\r\nfunction clearForm(root) {\r\n    state = structuredClone(emptyState);\r\n    refreshForm(root);\r\n}\r\n\r\nfunction refreshForm(root) {\r\n    refreshSingle(root.teacher, state.teacher);\r\n    refreshSingle(root.subject, state.subject);\r\n    refreshList(root.subs, state.subs);\r\n    refreshComment(root.comment, state.comment);\r\n}\r\n", "import * as strings from \"../strings.js\";\r\nimport {createMenu} from \"./tabs/tabMenu.js\";\r\nimport {createSearch} from \"./tabs/tabSearch.js\";\r\nimport {createTeacher} from \"./tabs/tabTeacher.js\";\r\nimport {createSubject} from \"./tabs/tabSubject.js\";\r\nimport {createLoginForm} from \"./tabs/tabLogin.js\";\r\nimport {createAddReviewForm} from \"./tabs/tabAddReview.js\";\r\nimport {fetchSearch, fetchTeacher, fetchSubject, fetchIsModerator} from \"../api/api.js\";\r\n\r\nlet header;\r\nlet isuBox, container, statusBox;\r\nlet input, inputReset, menuBtn;\r\nlet loginCallback = undefined;\r\nlet logoutCallback = undefined;\r\nlet content = 'dashboard';\r\nlet isAuth = false;\r\nlet isUserModerator = false;\r\nlet timeoutId;\r\nlet abortController;\r\n\r\n\r\n/** \u041A\u043E\u043D\u0442\u0440\u043E\u043B\u043B\u0435\u0440 \u0441\u0442\u0440\u0430\u043D\u0438\u0446\u044B */\r\nexport function createMainPage(logoutCallbackLocal, loginCallbackLocal=undefined) {\r\n    loginCallback = loginCallbackLocal;\r\n    logoutCallback = logoutCallbackLocal;\r\n    statusBox = document.querySelector('#reviews-status-box');\r\n    isuBox = document.querySelector('#reviews-isu-box');\r\n    container = document.querySelector('#reviews-container');\r\n    input = document.querySelector('#reviews-input');\r\n    inputReset = document.querySelector('#reviews-input-reset');\r\n    menuBtn = document.querySelector('#reviews-menu');\r\n    header = document.querySelector('#reviews-header');\r\n\r\n    inputReset.addEventListener('click', () => {\r\n        input.value = '';\r\n        input.focus();\r\n        clearMainPage();\r\n    });\r\n    menuBtn.addEventListener('click', clearMainPage)\r\n\r\n    input.addEventListener('input', inputEvent);\r\n    input.addEventListener('keydown', (event) => {\r\n        if (event.key === 'Enter') {\r\n            inputEvent();\r\n        }\r\n    });\r\n}\r\n\r\n/** \u0427\u0438\u0441\u0442\u0438\u043C \u0441\u0442\u0440\u0430\u043D\u0438\u0446\u0443 */\r\nexport function clearMainPage() {\r\n    content = 'dashboard';\r\n    header.innerHTML = strings.mainHeader;\r\n    statusBox.innerHTML = '';\r\n    container.innerHTML = '';\r\n    container.appendChild(createMenu(\r\n        isAuth, isUserModerator,\r\n        logoutCallback,\r\n        openAddReviewCallback\r\n    ));\r\n}\r\n\r\n/** \u041E\u0442\u043A\u0440\u044B\u0442\u044C login \u0444\u043E\u0440\u043C\u0443 */\r\nexport function openLoginForm() {\r\n    content = 'login';\r\n    header.innerHTML = strings.loginHeader;\r\n    container.innerHTML = \"\";\r\n    container.appendChild(createLoginForm(loginCallback));\r\n}\r\n\r\n/** \u0412 \u0441\u0442\u0430\u0442\u0443\u0441 \u0430\u0432\u0442\u043E\u0440\u0438\u0437\u043E\u0432\u0430\u043D\u043D\u043E\u0433\u043E */\r\nexport function resolveLogin(payload) {\r\n    isAuth = true;\r\n    isuBox.innerHTML = strings.authStatusText(payload?.isu, payload?.name);\r\n    if (loginCallback !== undefined) isuBox.removeEventListener('click', openLoginForm);\r\n    clearMainPage()\r\n\r\n    /** @param {ModeratorResponse} data */\r\n    fetchIsModerator().then(data => {\r\n        if (data?.access) {\r\n            isUserModerator = true;\r\n            console.log('You are moderator: ', isUserModerator);\r\n            clearMainPage();\r\n        }\r\n    }).catch(() => {})\r\n}\r\n\r\n/** \u0412 \u0441\u0442\u0430\u0442\u0443\u0441 \u043D\u0435 \u0430\u0432\u0442\u043E\u0440\u0438\u0437\u043E\u0432\u0430\u043D\u043D\u043E\u0433\u043E */\r\nexport function rejectLogin(isuBoxHTML) {\r\n    isAuth = false;\r\n    isUserModerator = false;\r\n    isuBox.innerHTML = isuBoxHTML;\r\n    if (loginCallback !== undefined) {\r\n        isuBox.removeEventListener('click', openLoginForm);\r\n        isuBox.addEventListener('click', openLoginForm);\r\n    }\r\n    clearMainPage()\r\n}\r\n\r\n/** \u041E\u0431\u0440\u0430\u0431\u043E\u0442\u043A\u0430 \u043E\u0442\u043F\u0440\u0430\u0432\u043A\u0438 */\r\nfunction inputEvent() {\r\n    content = 'search';\r\n    // debouncer\r\n    clearTimeout(timeoutId);\r\n    timeoutId = setTimeout(search, 300);\r\n}\r\n\r\n/** \u041E\u0431\u0440\u0430\u0431\u0430\u0442\u044B\u0432\u0430\u0435\u043C \u0432\u0432\u043E\u0434 \u0432 \u0441\u0442\u0440\u043E\u043A\u0443 \u043F\u043E\u0438\u0441\u043A\u0430 **/\r\nasync function search() {\r\n    const name = input.value.trim();\r\n    if (!name) {\r\n        statusBox.innerHTML = \"\";\r\n        return;\r\n    } else if (name.length < 3) {\r\n        statusBox.innerHTML = strings.fewCharactersText;\r\n        return;\r\n    }\r\n\r\n    statusBox.innerHTML = strings.loadingText;\r\n\r\n    abortController?.abort();\r\n    abortController = new AbortController();\r\n\r\n    fetchSearch(name, abortController).then(data => {\r\n        if (content !== 'search') return;\r\n        header.innerHTML = strings.mainHeader;\r\n        const searchBox = createSearch(data, load);\r\n        if (searchBox) {\r\n            statusBox.innerHTML = \"\";\r\n            container.innerHTML = \"\";\r\n            container.appendChild(searchBox);\r\n        } else {\r\n            container.innerHTML = \"\";\r\n            statusBox.innerHTML = strings.brokeSearchText;\r\n        }\r\n    }).catch(status => {\r\n        if (content !== 'search') return;\r\n        header.innerHTML = strings.mainHeader;\r\n        container.innerHTML = \"\";\r\n        statusBox.innerHTML = strings.statusSearchText(status);\r\n    })\r\n}\r\n\r\n/** \u0417\u0430\u0433\u0440\u0443\u0437\u043A\u0430 \u043E\u0442\u0437\u044B\u0432\u043E\u0432 \u043F\u043E \u043F\u0440\u0435\u043F\u043E\u0434\u0443/\u043F\u0440\u0435\u0434\u043C\u0435\u0442\u0443 **/\r\nasync function load(id, type) {\r\n    if (content !== 'search') return;\r\n    content = 'reviews'\r\n    statusBox.innerHTML = strings.loadingText;\r\n    switch (type) {\r\n        case 'teacher':\r\n            fetchTeacher(id).then(data => {\r\n                const teacher = createTeacher(data);\r\n                if (content !== 'reviews') return;\r\n                if (teacher !== null) {\r\n                    statusBox.innerHTML = \"\";\r\n                    container.innerHTML = \"\";\r\n                    container.appendChild(teacher);\r\n                    return;\r\n                }\r\n                statusBox.innerHTML = strings.brokeReviewsText;\r\n                content = 'search';\r\n            }).catch(status => {\r\n                statusBox.innerHTML = strings.statusReviewsText(status);\r\n                content = 'search';\r\n            })\r\n            break;\r\n        case 'subject':\r\n            fetchSubject(id).then(data => {\r\n                const subject = createSubject(data);\r\n                if (content !== 'reviews') return;\r\n                if (subject !== null) {\r\n                    statusBox.innerHTML = \"\";\r\n                    container.innerHTML = \"\";\r\n                    container.appendChild(subject);\r\n                    return;\r\n                }\r\n                statusBox.innerHTML = strings.brokeReviewsText;\r\n                content = 'search';\r\n            }).catch(status => {\r\n                statusBox.innerHTML = strings.statusReviewsText(status);\r\n                content = 'search';\r\n            })\r\n            break;\r\n        default:\r\n            console.error(`\u041D\u0435\u0438\u0437\u0432\u0435\u0441\u0442\u043D\u044B\u0439 type ${type}`);\r\n            statusBox.innerHTML = strings.unknownTypeText;\r\n            content = 'search';\r\n    }\r\n}\r\n\r\nfunction openAddReviewCallback() {\r\n    content = 'add-review';\r\n    header.innerHTML = strings.addHeader;\r\n    statusBox.innerHTML = '';\r\n    container.innerHTML = '';\r\n    container.appendChild(createAddReviewForm(clearMainPage));\r\n}", "'use strict';\r\n\r\nimport {createMainPage, clearMainPage, resolveLogin, rejectLogin} from \"./ui/main.js\";\r\nimport {isAuth, loadTokensPage, resetTokensPage} from \"./api/authp.js\";\r\n\r\nconst isuBoxHTML = `<a>\u0412\u0445\u043E\u0434</a>`;\r\nconst logoutConfirm = \"\u0412\u044B \u0442\u043E\u0447\u043D\u043E \u0445\u043E\u0442\u0438\u0442\u0435 \u0432\u044B\u0439\u0442\u0438 \u0438\u0437 \u0430\u043A\u043A\u0430\u0443\u043D\u0442\u0430?\";\r\n\r\ndocument.addEventListener('DOMContentLoaded', main);\r\n\r\nasync function main() {\r\n    createMainPage(logoutCallback, loginCallback);\r\n    loadTokensPage().then((payload) => {\r\n        resolveLogin(payload);\r\n    }).catch(() => {\r\n        rejectLogin(isuBoxHTML)\r\n    })\r\n}\r\n\r\nfunction loginCallback() {\r\n    loadTokensPage().then((payload) => {\r\n        resolveLogin(payload);\r\n        clearMainPage();\r\n    }).catch(() => {\r\n        rejectLogin(isuBoxHTML)\r\n    })\r\n}\r\n\r\nfunction logoutCallback() {\r\n    if (!isAuth()) return;\r\n    const confirmation = confirm(logoutConfirm);\r\n    if (!confirmation) return;\r\n    resetTokensPage();\r\n    rejectLogin(isuBoxHTML);\r\n    clearMainPage();\r\n}\r\n"],
  "mappings": "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",
  "names": ["loadingText", "tip", "fewCharactersText", "unknownTypeText", "brokeReviewsText", "brokeSearchText", "emptyCommentsList", "statusReviewsText", "status", "statusSearchText", "authStatusText", "isu", "name", "symbols", "authpLabel", "authpCredentials", "authpError", "loginBtnLabel", "loginLoadingBtnLabel", "menuLogoutBtnLabel", "menuAddReviewBtnLabel", "menuMyReviewBtnLabel", "mainHeader", "loginHeader", "addHeader", "createMenu", "isAuth", "isUserModerator", "logoutCallback", "openAddReviewCallback", "wrapper", "addReviewButton", "menuAddReviewBtnLabel", "myReviewButton", "menuMyReviewBtnLabel", "logoutButton", "menuLogoutBtnLabel", "createSearch", "data", "callback", "wrapper", "s", "item", "symbols", "parseJwt", "token", "base64", "binary", "bytes", "c", "json", "e", "parseCommentDate", "dateStr", "untilMatch", "year", "match", "hh", "mm", "dd", "MM", "yyyy", "setCookie", "key", "value", "options", "days", "path", "sameSite", "secure", "cookie", "getCookie", "row", "normalizeString", "str", "isExtension", "refreshToken", "accessToken", "accessTokenExpiration", "TIMEOUT", "isAuth", "setTokens", "rToken", "aToken", "payload", "parseJwt", "isAccessTokenExpired", "validateTokenISU", "saveTokensExtension", "err", "resetTokensExtension", "isExtension", "refreshToken", "accessToken", "accessTokenExpiration", "saveTokensPage", "rToken", "aToken", "setCookie", "loadTokensPage", "resolve", "reject", "getCookie", "setTokens", "payloadAT", "parseJwt", "resetTokensPage", "saveTokensAuto", "saveTokensExtension", "resetTokensAuto", "isExtension", "resetTokensExtension", "resetTokensPage", "fetchJSON", "method", "path", "options", "controller", "url", "fetchOptions", "refreshToken", "accessToken", "isAccessTokenExpired", "urlRefresh", "resp", "aToken", "validateTokenISU", "saveTokensAuto", "resetTokensAuto", "err", "key", "value", "resolve", "reject", "res", "text", "errorDetail", "fetchSearch", "query", "strainer", "fetchTeacher", "id", "fetchSubject", "fetchTeacherRate", "user_rating", "fetchCommentVote", "user_karma", "fetchAuthPLogin", "username", "password", "fetchIsModerator", "fetchSendSuggestion", "body", "fetchCancelSuggestion", "id", "status", "fetchJSON", "createComments", "commentsData", "wrapper", "commentsList", "createCommentsList", "dropdown", "createDropdown", "event", "model", "newCL", "sortComments", "cData", "createComment", "comment", "createKarma", "id", "karma", "user_karma", "karmaSpan", "upBtn", "downBtn", "_event", "data", "fetchCommentVote", "updateKarma", "comments", "a", "b", "timeA", "parseCommentDate", "timeB", "diff", "createRating", "id", "rating", "user_rating", "wrapper", "renderRating", "event", "newRate", "data", "fetchTeacherRate", "stars", "num", "createSummaries", "summariesData", "summariesHTML", "item", "summaries", "createReviewsContentBox", "data", "wrapper", "createRating", "createSummaries", "createComments", "comment", "emptyCommentsList", "createTeacher", "data", "reviewBox", "createReviewsContentBox", "wrapper", "createSubject", "data", "a", "b", "rating", "reviewBoxes", "teacher", "createReviewsContentBox", "box", "wrapper", "i", "createLoginForm", "loginCallback", "form", "authpLabel", "loginButton", "e", "loginLoadingBtnLabel", "fetchAuthPLogin", "resp", "rToken", "aToken", "loginBtnLabel", "validateTokenISU", "saveTokensPage", "status", "authpCredentials", "authpError", "getElements", "root", "renderAddReviewForm", "isUserModerator", "isUserModerator", "clearFormCallback", "emptyState", "state", "createAddReviewForm", "clearFormCallbackLocal", "modeModerator", "suggestionId", "wrapper", "renderAddReviewForm", "root", "getElements", "bindEvents", "refreshForm", "inputState", "e", "key", "refreshList", "cancelSuggestion", "clearForm", "sendSuggestion", "inputEvent", "length", "exceeded", "scrollY", "search", "loadSingle", "loadList", "event", "normalizeString", "requestBody", "fetchSendSuggestion", "_", "status", "fetchCancelSuggestion", "data", "rootEl", "is", "s", "load", "fetchSearch", "searchBox", "createSearch", "id", "type", "title", "brokeSearchText", "statusSearchText", "newTitle", "refreshSingle", "revList", "item", "refreshComment", "header", "isuBox", "container", "statusBox", "input", "inputReset", "menuBtn", "loginCallback", "logoutCallback", "content", "isAuth", "isUserModerator", "timeoutId", "abortController", "createMainPage", "logoutCallbackLocal", "loginCallbackLocal", "clearMainPage", "inputEvent", "event", "mainHeader", "createMenu", "openAddReviewCallback", "openLoginForm", "loginHeader", "createLoginForm", "resolveLogin", "payload", "authStatusText", "fetchIsModerator", "data", "rejectLogin", "isuBoxHTML", "search", "name", "fewCharactersText", "loadingText", "fetchSearch", "searchBox", "createSearch", "load", "brokeSearchText", "status", "statusSearchText", "id", "type", "fetchTeacher", "teacher", "createTeacher", "brokeReviewsText", "statusReviewsText", "fetchSubject", "subject", "createSubject", "unknownTypeText", "addHeader", "createAddReviewForm", "isuBoxHTML", "logoutConfirm", "main", "createMainPage", "logoutCallback", "loginCallback", "loadTokensPage", "payload", "resolveLogin", "rejectLogin", "clearMainPage", "isAuth", "resetTokensPage"]
}
